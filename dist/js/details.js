"use strict";$(function(){function p(t,s){$.ajax({type:"get",url:"../api/main.php",data:t,success:function(t){var a=JSON.parse(t);s(a)},async:!0})}$(window).on("scroll",function(){210<=$(window).scrollTop()?$("#r-aside").css("position","fixed").css("top","65px"):$("#r-aside").css("position","absolute").css("top","210px")}),$(".u-ck").on("click",function(){1==$(this).prop("checked")?$(this).css("background-position","0 0"):$(this).css("background-position","0 -48px")}),$("#result").on("click","li a",function(){var t=$(this).parents(".goods").attr("data-id");location.href="goods.html?gid="+t});var e={a:"getList",sqlname:"goods",page:1,qty:40};p(e,function(t){v(t),u(t.data.pages,t.data.page)});var r=!0,l=!0,d="gid",g=!1;function t(){var t="desc",a="",s=[];if(1==$("#kaola").prop("checked")&&s.push("kaola ='y'"),1==$("#youhuo").prop("checked")&&s.push("number >0"),1==$("#cuxiao").prop("checked")&&s.push("chuxiao ='y'"),1==$("#gongchangdian").prop("checked")&&s.push("gongchangdian ='y'"),1*$(".m-priceBox .priceInputs .max_money").val()){var n=1*$(".m-priceBox .priceInputs .max_money").val(),c=1*$(".m-priceBox .priceInputs .min_money").val()?1*$(".m-priceBox .priceInputs .min_money").val():0;if(g&&c<n){var i="newprice BETWEEN "+c+" and "+n;s.push(i)}}console.log(s),"newgoods"==d?(a="gid",s.push("newgoods ='y'")):a=d,"sales"==d&&($("#sales .arrow").css("display","block"),l?(t="desc",$("#sales .arrow").removeClass("arrow_up")):(t="asc",$("#sales .arrow").addClass("arrow_up")),l=!l),"newprice"==d&&($("#newprice .arrow").css("display","block"),1==r?(t="desc",$("#newprice .arrow").removeClass("arrow_up")):(t="asc",$("#newprice .arrow").addClass("arrow_up")),r=!r);var o=s.join(" and ");p(e={a:"sort",sqlname:"goods",page:1,qty:40,type:a,where:o,DOA:t},function(t){console.log(t),v(t),u(t.data.pages,t.data.page)})}$("#order .order").on("click","dd",function(){$("#order .order .arrow").css("display","none"),$("#order .order .jtag").removeClass("active"),$(this).addClass("active"),d=$(this).attr("id"),t()}),$(".m-priceBox .priceInputs").on("click",".clearbtn",function(){$(".m-priceBox .priceInputs input").val("")}),$(".m-priceBox .priceInputs").on("click",".btnconfirm",function(){g=!0,t()}),$(".otherC").on("click",function(){t()});var a=1;function u(t,a){var s="";s=1==a?'<span class="upage unsacitve">上一页</span>':'<span class="upage sacive">上一页</span>';for(var n=1;n<=t;n++)s+=n==a?'<span class="page active">'+n+"</span>":'<span class="page ">'+n+"</span>";s+=a==t?'<span class="npage unsacitve">下一页</span>':'<span class="npage sacive">下一页</span>',$("#pageNum").html(s)}function v(t){for(var a="",s=0;s<t.data.list.length;s++){var n=t.data.list[s],c="";"y"==n.kaola&&(c+='<span class="activity ziying">自营</span>'),c+='<span class="activity">99选3</span>\n\t\t\t\t\t\t\t<span class="activity">包税</span>\n\t\t\t\t\t\t\t<span class="activity">白条优惠</span>',a+='<li class="goods" data-id="'+n.gid+'">\n\t\t\t\t\t\t\t\t\t<div class="goodswrap">\n\t\t\t\t\t\t\t\t\t\t<a href="javascript:;">\n\t\t\t\t\t\t\t\t\t\t\t<div class="img">\n\t\t\t\t\t\t\t\t\t\t\t\t<img src="../'+n.bigimg+'" alt="" />\n\t\t\t\t\t\t\t\t\t\t\t\t<img class="ranksTap" src="../img/baitiao.png" alt="" />\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t\t<div class="desc clearfix">\n\t\t\t\t\t\t\t\t\t\t\t<p class="goodsprice">\n\t\t\t\t\t\t\t\t\t\t\t\t<span class="cur">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<i>￥</i>'+n.newprice+'\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t<span class="oldprice">\n\t\t\t\t\t\t\t\t\t\t\t\t\t￥<del>'+n.oldprice+'</del>\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t<a class="title" title="'+n.goodname+'" href="javascript:;">\n\t\t\t\t\t\t\t\t\t\t\t\t<h2>'+n.goodname+'</h2>\n\t\t\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t\t\t<p class="saelsinfo">\n\t\t\t\t\t\t\t\t\t\t\t\t'+c+'\n\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t<p class="goodsinfo clearfix">\n\t\t\t\t\t\t\t\t\t\t\t\t<a href="javascript:;">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="icon"></span> '+n.comment+'\n\t\t\t\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t\t\t\t<span class="proPlace">日本</span>\n\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t<p class="selfflag">\n\t\t\t\t\t\t\t\t\t\t\t\t<span>'+n.brand+"</span>\n\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</li>"}$("#result").html(a)}$("#pageNum").on("click","span",function(){"上一页"==$(this).text()?1<a&&a--:"下一页"==$(this).text()?a<$("#pageNum span").length-2&&a++:a=1*$(this).text(),e.page=a,p(e,function(t){v(t),u(t.data.pages,t.data.page),$(window).scrollTop(0)})})});